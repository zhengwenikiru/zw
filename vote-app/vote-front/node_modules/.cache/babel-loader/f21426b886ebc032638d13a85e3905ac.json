{"ast":null,"code":"import _asyncToGenerator from\"/Users/zhengwen/Desktop/zw/vote-app/vote-front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/zhengwen/Desktop/zw/vote-app/vote-front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/zhengwen/Desktop/zw/vote-app/vote-front/node_modules/@babel/runtime/regenerator/index.js\";// 投票查看及交互页面\nimport{useParams}from\"react-router-dom\";import axios from\"axios\";import{useEffect,useState,useMemo}from\"react\";import{forceLogin,useAxios}from'./hooks';import'./ViewVote.css';import _ from'lodash';import dayjs from'dayjs';import{useImmer}from\"use-immer\";import{Button,Divider,Progress}from'antd';import'antd/dist/antd.css';/**\n * 投票页面的信息是实时更新的\n * 实现这个需求有两种方案：\n * 一是页面加载成功后一直不断的发ajax请求来获取最新的数据，并展示出来\n *  这种做法在投票已经创建出很久以后就不够好了，因为如果创建出很久以后，大概率是不会更新的\n *  发出请求大概率是没有获取到最新信息的\n * 第二种方案为http长连接，也叫comet，即服务器在收到客户端发来的ajax请求后\n *  如果没有数据要回复给客户端，则服务器hold住这个连接，直到超时后响应空内容，或在有数据后立刻响应该请求\n *    微信/钉钉的登陆都是这个方案\n * 第三种：websocket\n *  页面加载成功后向服务器建立一个websocket连接，如果服务器有新的数据，则直接在这个ws连接上响应客户端\n *    而不用客户端主动的一直发请求\n *\n *\n *\n */import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function ViewVote(_ref){var _ref2;var userInfo=_ref.userInfo;var _useParams=useParams(),voteId=_useParams.voteId;var _useAxios=useAxios({url:\"/vote/\".concat(voteId)}),loading=_useAxios.loading,data=_useAxios.data,error=_useAxios.error,update=_useAxios.update;var _useState=useState(),_useState2=_slicedToArray(_useState,2),userVotes=_useState2[0],setUserVotes=_useState2[1];// 从websocket上获取到的实时信息\nvar _useImmer=useImmer([]),_useImmer2=_slicedToArray(_useImmer,2),selectedOptionIds=_useImmer2[0],setSelectedOptionIds=_useImmer2[1];useEffect(function(){// 如果还在加载，或者是超过截止时间，则什么也不做\nif(loading||Date.now()>new Date(data.vote.deadline).getTime()){return;}var wsUrl=\"\".concat(window.location.protocol.replace('http','ws'),\"//\").concat(window.location.host,\"/realtime-voteinfo/\").concat(voteId);var ws=new WebSocket(wsUrl);// 实时接受服务器发来的最新消息\nws.onmessage=function(e){var data=JSON.parse(e.data);setUserVotes(data);};return function(){return ws.close();};},[loading,voteId]);// 为某个选项投票/或取消投票\nfunction voteOption(_x){return _voteOption.apply(this,arguments);}function _voteOption(){_voteOption=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(option){var optionId;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(data.vote.anonymous){_context.next=6;break;}optionId=option.optionId;_context.next=4;return axios.post(\"/vote/\".concat(voteId),{optionIds:[optionId]});case 4:_context.next=9;break;case 6:_context.next=8;return axios.post(\"/vote/\".concat(voteId),{optionIds:selectedOptionIds});case 8:setSelectedOptionIds([]);case 9:case\"end\":return _context.stop();}}},_callee);}));return _voteOption.apply(this,arguments);}function selectOption(option){var optionId=option.optionId;if(selectedOptionIds.includes(optionId)){setSelectedOptionIds(function(selectedOptionIds){var idx=selectedOptionIds.indexOf(optionId);selectedOptionIds.splice(idx,1);});}else{setSelectedOptionIds(function(selectedOptionIds){selectedOptionIds.push(optionId);});}}function handleOptionClick(option){if(data.vote.anonymous){if(votes.some(function(it){return it.userId===userInfo.data.userId;})){return;}selectOption(option);}else{voteOption(option);}}var votes=(_ref2=userVotes!==null&&userVotes!==void 0?userVotes:data===null||data===void 0?void 0:data.userVotes)!==null&&_ref2!==void 0?_ref2:[];var groupedVotes=useMemo(function(){return _.groupBy(votes,'optionId');},[votes]);//用投票选项ID分组,\n//{optionId:[]}\nvar uniqueUserCount=useMemo(function(){return _.uniqBy(votes,'userId').length;},[votes]);// 去掉同用户投票后的数量,即选项有多少人投了\nif(loading)return'Loading...';return/*#__PURE__*/_jsx(\"div\",{className:\"father\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Divider,{orientation:\"left\",children:/*#__PURE__*/_jsxs(\"h2\",{children:[\"\\u6295\\u7968\\u6807\\u9898:\",data.vote.title]})}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#3269da'},children:[\"[\",data.vote.multiple?'多选':'单选',\"](\\u591A\\u6295\\u53EA\\u53D6\\u7B2C\\u4E00\\u4E2A)\"]}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#3269da'},children:[\"[\",data.vote.anonymous?'匿名':'公开',\"]\"]}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"\\u63CF\\u8FF0:\",data.vote.desc]}),/*#__PURE__*/_jsx(\"ol\",{children:data.options.map(function(option){//option是每个选项\nvar thisOptionVotes=groupedVotes[option.optionId]||[];return/*#__PURE__*/_jsxs(\"li\",{onClick:function onClick(){return handleOptionClick(option);},children:[option.content,\"(\\u7968\\u6570:\",thisOptionVotes.length,\")\",thisOptionVotes.some(function(it){return it.userId==userInfo.data.userId;})?'✔️':'',/*#__PURE__*/_jsx(\"div\",{style:{width:'170px'},children:/*#__PURE__*/_jsx(Progress,{size:\"small\",percent:uniqueUserCount==0?0:(thisOptionVotes.length/uniqueUserCount*100).toFixed(2)})}),selectedOptionIds.includes(option.optionId)?'✔️':'',/*#__PURE__*/_jsx(\"div\",{}),thisOptionVotes.map(function(oneVote){return/*#__PURE__*/_jsx(\"span\",{className:\"user-id\",children:oneVote.userId},oneVote.userId);})]},option.optionId);})}),!!data.vote.anonymous&&!votes.some(function(it){return it.userId==userInfo.data.userId;})&&/*#__PURE__*/_jsx(Button,{disabled:!selectedOptionIds.length,onClick:voteOption,children:\"\\u786E\\u5B9A\\u6295\\u7968\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u6295\\u7968\\u622A\\u6B62\\u65E5\\u671F:\",dayjs(data.vote.deadline).format('YYYY-MM-DD HH:mm')]})]})});}export default forceLogin(ViewVote);","map":{"version":3,"sources":["/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/ViewVote.js"],"names":["useParams","axios","useEffect","useState","useMemo","forceLogin","useAxios","_","dayjs","useImmer","Button","Divider","Progress","ViewVote","userInfo","voteId","url","loading","data","error","update","userVotes","setUserVotes","selectedOptionIds","setSelectedOptionIds","Date","now","vote","deadline","getTime","wsUrl","window","location","protocol","replace","host","ws","WebSocket","onmessage","e","JSON","parse","close","voteOption","option","anonymous","optionId","post","optionIds","selectOption","includes","idx","indexOf","splice","push","handleOptionClick","votes","some","it","userId","groupedVotes","groupBy","uniqueUserCount","uniqBy","length","title","color","multiple","desc","options","map","thisOptionVotes","content","width","toFixed","oneVote","format"],"mappings":"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","sourcesContent":["// 投票查看及交互页面\n\nimport { useParams } from \"react-router-dom\"\nimport axios from \"axios\"\nimport { useEffect, useState, useMemo } from \"react\"\nimport { forceLogin, useAxios } from './hooks'\nimport './ViewVote.css'\nimport _ from 'lodash'\nimport dayjs from 'dayjs'\nimport { useImmer } from \"use-immer\"\nimport{ Button,Divider,Progress } from 'antd'\nimport 'antd/dist/antd.css';\n\n\n\n\n/**\n * 投票页面的信息是实时更新的\n * 实现这个需求有两种方案：\n * 一是页面加载成功后一直不断的发ajax请求来获取最新的数据，并展示出来\n *  这种做法在投票已经创建出很久以后就不够好了，因为如果创建出很久以后，大概率是不会更新的\n *  发出请求大概率是没有获取到最新信息的\n * 第二种方案为http长连接，也叫comet，即服务器在收到客户端发来的ajax请求后\n *  如果没有数据要回复给客户端，则服务器hold住这个连接，直到超时后响应空内容，或在有数据后立刻响应该请求\n *    微信/钉钉的登陆都是这个方案\n * 第三种：websocket\n *  页面加载成功后向服务器建立一个websocket连接，如果服务器有新的数据，则直接在这个ws连接上响应客户端\n *    而不用客户端主动的一直发请求\n *\n *\n *\n */\nfunction ViewVote({ userInfo }) {\n  var { voteId } = useParams()\n  var { loading, data, error, update } = useAxios({ url: `/vote/${voteId}` })\n  var [userVotes, setUserVotes] = useState() // 从websocket上获取到的实时信息\n  var [selectedOptionIds, setSelectedOptionIds] = useImmer([])\n\n  useEffect(() => {\n    // 如果还在加载，或者是超过截止时间，则什么也不做\n    if (loading || Date.now() > new Date(data.vote.deadline).getTime()) {\n      return\n    }\n\n    var wsUrl = `${window.location.protocol.replace('http', 'ws')}//${window.location.host}/realtime-voteinfo/${voteId}`\n\n    var ws = new WebSocket(wsUrl)\n\n    // 实时接受服务器发来的最新消息\n    ws.onmessage = function (e) {\n      var data = JSON.parse(e.data)\n      setUserVotes(data)\n    }\n\n    return () => ws.close()\n  }, [loading, voteId])\n\n  // 为某个选项投票/或取消投票\n  async function voteOption(option) {\n    if (!data.vote.anonymous) {\n      var { optionId } = option\n      await axios.post(`/vote/${voteId}`, {\n        optionIds: [optionId]\n      })\n    } else { // 匿名的话，发选中的\n      await axios.post(`/vote/${voteId}`, {\n        optionIds: selectedOptionIds\n      })\n      setSelectedOptionIds([])\n    }\n  }\n\n  function selectOption(option) {\n    var { optionId } = option\n    if (selectedOptionIds.includes(optionId)) {\n      setSelectedOptionIds(selectedOptionIds => {\n        var idx = selectedOptionIds.indexOf(optionId)\n        selectedOptionIds.splice(idx, 1)\n      })\n    } else {\n      setSelectedOptionIds(selectedOptionIds => {\n        selectedOptionIds.push(optionId)\n      })\n    }\n  }\n\n  function handleOptionClick(option) {\n    if (data.vote.anonymous) {\n      if (votes.some(it => it.userId === userInfo.data.userId)) {\n        return\n      }\n      selectOption(option)\n    } else {\n      voteOption(option)\n    }\n  }\n\n  var votes = userVotes ?? data?.userVotes ?? []\n\n  var groupedVotes    = useMemo(() => _.groupBy(votes, 'optionId'), [votes])//用投票选项ID分组,\n  //{optionId:[]}\n  var uniqueUserCount = useMemo(() => _.uniqBy(votes, 'userId').length, [votes]) // 去掉同用户投票后的数量,即选项有多少人投了\n\n\n  if (loading) return 'Loading...'\n\n  return (\n    <div className=\"father\">\n      <div>\n         <Divider orientation=\"left\"><h2>投票标题:{data.vote.title}</h2></Divider>\n    \n      <span style={{color: '#3269da'}}>[{data.vote.multiple ? '多选' : '单选'}](多投只取第一个)</span>\n      <span style={{color: '#3269da'}}>[{data.vote.anonymous ? '匿名' : '公开'}]</span>\n      <h3>描述:{data.vote.desc}</h3>\n      <ol>\n        {\n          data.options.map(option => {\n           //option是每个选项\n            var thisOptionVotes = groupedVotes[option.optionId] || []\n\n            return (\n              <li onClick={() => handleOptionClick(option)} key={option.optionId}>\n                {option.content}\n                (票数:{thisOptionVotes.length})\n                {thisOptionVotes.some(it => it.userId == userInfo.data.userId) ? '✔️' : ''}\n                <div style={{width:'170px'}}>\n                <Progress size=\"small\" percent={uniqueUserCount == 0 ? 0 : (thisOptionVotes.length / uniqueUserCount * 100).toFixed(2)}/>\n                </div>\n                {/* [{uniqueUserCount == 0 ? 0 : (thisOptionVotes.length / uniqueUserCount * 100).toFixed(2)}%] */}\n\n                {/* 当选选项的任意一票是当前登陆用户，则说明当前用户已经选择该选项 */}\n\n                {selectedOptionIds.includes(option.optionId) ? '✔️' : ''}\n\n                <div/>\n                {\n                  thisOptionVotes.map(oneVote => {\n                    return <span key={oneVote.userId} className=\"user-id\">{oneVote.userId}</span>\n                  })\n                }\n              </li>\n            )\n          })\n        }\n      </ol>\n\n      {/* 匿名且当前用户没投过才显示确定投票按钮 */}\n      {!!data.vote.anonymous && !votes.some(it => it.userId == userInfo.data.userId) &&\n        <Button disabled={!selectedOptionIds.length} onClick={voteOption}>确定投票</Button>\n      }\n\n      <p>投票截止日期:{dayjs(data.vote.deadline).format('YYYY-MM-DD HH:mm')}</p>\n      </div>\n     \n    </div>\n  )\n}\n\nexport default forceLogin(ViewVote)\n"]},"metadata":{},"sourceType":"module"}