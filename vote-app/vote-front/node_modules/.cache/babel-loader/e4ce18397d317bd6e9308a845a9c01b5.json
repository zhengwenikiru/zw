{"ast":null,"code":"var _jsxFileName = \"/Users/zhengwen/Desktop/vote/vote-front/src/hooks.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$(),\n    _s5 = $RefreshSig$();\n\nimport { useCallback, useState, useMemo, useEffect, useContext } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { UserContext } from './CurrentUserInfo';\nimport axios from \"axios\";\nimport RequireLogin from './RequireLogin';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function useInput() {\n  _s();\n\n  let init = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  var [value, setValue] = useState(init);\n  var onChange = useCallback(function onChange(e) {\n    setValue(e.target.value);\n  }, []);\n  return {\n    value,\n    onChange\n  };\n}\n\n_s(useInput, \"56g7Bv7DNfzNKa9KMDwmfNNV4nI=\");\n\nexport function useBooleanInput() {\n  _s2();\n\n  let init = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n  var [checked, setChecked] = useState(init);\n  var onChange = useCallback(function onChange(e) {\n    setChecked(e.target.checked);\n  }, []);\n  return {\n    checked,\n    onChange\n  };\n}\n\n_s2(useBooleanInput, \"9Mamt7qSi5d8XrsRtTO/BdG9hSc=\");\n\nexport function useQuery() {\n  _s3();\n\n  var search = useLocation().search;\n  return useMemo(() => new URLSearchParams(search), [search]);\n} //从url中获取?后面的部分\n\n_s3(useQuery, \"z3d/mcTWC4E3z8BNMd0PwL5/N3w=\", false, function () {\n  return [useLocation];\n});\n\nexport function useAxios(config) {\n  _s4();\n\n  var [data, setData] = useState(); //用于存放请求结果的\n\n  var [error, setError] = useState(); //用于存放错误结果\n\n  var [loading, setLoading] = useState(); //是否还在加载中\n\n  useEffect(() => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n    var req = axios({ ...config,\n      cancelToken: source.token\n    });\n    req.then(res => {\n      if (res.data.code == 0) {\n        setData(res.data.result);\n      } else {\n        setError(res.data.msg);\n      }\n\n      setLoading(false);\n    }).catch(e => {\n      setError(e.toString());\n      setLoading(false);\n    });\n    return () => source.cancel();\n  }, [config.url]);\n  var update = useCallback(function update() {\n    setLoading(true);\n  }, []);\n  return {\n    data,\n    loading,\n    error,\n    update\n  };\n} //拿到当前登陆用户的业务Hook\n\n_s4(useAxios, \"Ys5G0o5DqEqVo00QcN6ohi88n+k=\");\n\nexport function useUser() {\n  _s5();\n\n  return useContext(UserContext); //拿到CurentUserInfo文件中 UserContext.Provider传的 userInfo的信息\n} //强制登陆的高阶组件，用它包裹的组件必须登陆才能显示\n\n_s5(useUser, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport function forceLogin(Comp) {\n  var _s6 = $RefreshSig$(),\n      _Comp$displayName;\n\n  function ForceLoginComp(props) {\n    _s6();\n\n    var userInfo = useUser();\n\n    if (userInfo.loading) {\n      return null;\n    }\n\n    if (userInfo.error) {\n      return /*#__PURE__*/_jsxDEV(RequireLogin, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 16\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(Comp, { ...props,\n      userInfo: userInfo\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 14\n    }, this);\n  }\n\n  _s6(ForceLoginComp, \"lxeFcid5QSsbUdffvmePeNN7wLs=\", false, function () {\n    return [useUser];\n  });\n\n  ForceLoginComp.displayName = 'ForceLogin' + ((_Comp$displayName = Comp.displayName) !== null && _Comp$displayName !== void 0 ? _Comp$displayName : Comp.name);\n  return ForceLoginComp;\n}","map":{"version":3,"sources":["/Users/zhengwen/Desktop/vote/vote-front/src/hooks.js"],"names":["useCallback","useState","useMemo","useEffect","useContext","useLocation","UserContext","axios","RequireLogin","useInput","init","value","setValue","onChange","e","target","useBooleanInput","checked","setChecked","useQuery","search","URLSearchParams","useAxios","config","data","setData","error","setError","loading","setLoading","CancelToken","source","req","cancelToken","token","then","res","code","result","msg","catch","toString","cancel","url","update","useUser","forceLogin","Comp","ForceLoginComp","props","userInfo","displayName","name"],"mappings":"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","sourcesContent":["import { useCallback,useState ,useMemo,useEffect, useContext} from \"react\"\nimport { useLocation } from \"react-router-dom\"\nimport{ UserContext } from './CurrentUserInfo'\nimport axios from \"axios\"\nimport RequireLogin from './RequireLogin'\n\nexport function useInput(init=''){\n  var [value,setValue] = useState(init)\n  var onChange = useCallback(function onChange(e){\n      setValue(e.target.value)\n  },[])\n  return{\n    value,onChange\n  }\n}\n\nexport function useBooleanInput(init = false){\n  var [checked,setChecked] = useState(init)\n  var onChange = useCallback(function onChange(e){\n    setChecked(e.target.checked)\n  },[])\n  return {\n    checked,onChange\n  }\n}\n\nexport function useQuery(){\n  var search = useLocation().search\n  return useMemo(()=>new URLSearchParams(search),[search])\n}\n//从url中获取?后面的部分\n\n\nexport function useAxios(config){\n  var [data,setData] = useState()//用于存放请求结果的\n  var [error,setError] = useState()//用于存放错误结果\n  var [loading,setLoading] = useState() //是否还在加载中\n  useEffect(()=>{\n    const CancelToken = axios.CancelToken\n    const source = CancelToken.source()\n    var req = axios({\n      ...config,\n      cancelToken:source.token\n    })\n\n    req.then(res => {\n      if(res.data.code == 0){\n        setData(res.data.result)\n      }else{\n        setError(res.data.msg)\n      }\n      setLoading(false)\n    }).catch(e=>{\n      setError(e.toString())\n      setLoading(false)\n    })\n\n    return ()=>source.cancel()\n },[config.url])\n \n var update = useCallback(function update(){\n   setLoading(true)\n },[])\n return {\n   data,\n   loading,\n   error,\n   update,\n }\n}\n\n//拿到当前登陆用户的业务Hook\nexport function useUser(){\n  return useContext(UserContext)\n  //拿到CurentUserInfo文件中 UserContext.Provider传的 userInfo的信息\n}\n\n\n//强制登陆的高阶组件，用它包裹的组件必须登陆才能显示\n  export function forceLogin(Comp){\n    function ForceLoginComp(props){\n      var userInfo = useUser()\n      if(userInfo.loading){\n        return  null\n      }\n      if(userInfo.error){\n        return <RequireLogin/>\n      }\n      return <Comp {...props} userInfo = {userInfo}  />\n    }\n\n    ForceLoginComp.displayName = 'ForceLogin' +(Comp.displayName ?? Comp.name)\n\n    return ForceLoginComp\n  }"]},"metadata":{},"sourceType":"module"}