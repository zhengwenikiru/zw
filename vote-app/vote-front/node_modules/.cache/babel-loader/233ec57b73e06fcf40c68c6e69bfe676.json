{"ast":null,"code":"var _jsxFileName = \"/Users/zhengwen/Desktop/vote/vote-front/src/Create-vote.js\",\n    _s = $RefreshSig$();\n\n//创建投票界面\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { produce } from \"immer\";\nimport { useInput, useQuery, useBooleanInput, forceLogin } from \"./hooks\";\nimport { useMemo, useState } from \"react\";\nimport dayjs from \"dayjs\"; // import './create-vote.css'\n\nimport { List, Divider } from 'antd';\nimport 'antd/dist/antd.css'; //use-immer是对useState的简单包装。不必再调produce，可以对任意数据类型进行修改\n//传给setOption的函数就是用于修改的函数§\n// import { set } from \"immer/dist/internal\"\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction CreateVote(_ref) {\n  _s();\n\n  let {\n    userInfo\n  } = _ref;\n  var [options, setOptions] = useState(['', '']);\n  var title = useInput();\n  var desc = useInput();\n  var deadline = useInput(useMemo(() => dayjs().add(1, 'week').format('YYYY-MM-DDTHH:mm'), []));\n  var anonymous = useBooleanInput();\n  var navigate = useNavigate();\n  var query = useQuery();\n\n  function remove(idx) {\n    setOptions(produce(options, options => {\n      options.splice(idx, 1);\n    }));\n  }\n\n  function setOption(idx, val) {\n    setOptions(produce(options, options => {\n      options[idx] = val;\n    }));\n    console.log(options);\n  }\n\n  async function create() {\n    var vote = {\n      title: title.value,\n      desc: desc.value,\n      options: options,\n      deadline: deadline.value,\n      anonymous: anonymous.checked,\n      multiple: query.get('multiple') === '1' ? true : false\n    };\n    console.log(vote);\n\n    try {\n      var res = await axios.post('/vote', vote);\n      var createdVote = res.data.result; //data里有创建好的投票信息\n\n      navigate(\"/view-vote/\" + createdVote.voteId);\n    } catch (e) {\n      throw e;\n    }\n  }\n\n  return (\n    /*#__PURE__*/\n    // <div id=\"fa\">\n    //   <h1 style={{margin:'0 auto'}}>创建投票</h1>\n    //   <div className=\"inputs\"><input type=\"text\" placeholder=\"投票标题\" {...title}/></div>\n    //   <div className=\"inputs\"><input type=\"text\" placeholder=\"补充描述(选填)\" {...desc}/></div>\n    //   {\n    //     options.map((option, idx) =>\n    //       <div key={idx} className=\"inputs\">\n    //         <div>\n    //         <input className=\"option\" type=\"text\" placeholder=\"选项\" value={option} onChange={e => setOption(idx, e.target.value)}/>\n    //         <button tabIndex=\"-1\" onClick={() => remove(idx)}>×</button>\n    //         </div>\n    //       </div>\n    //     )\n    //   }\n    //     <div className='bottom'>\n    //     <div> <button onClick={() => setOptions(options => [...options,''])}>添加选项</button></div>\n    //     <div className=\"any\" title=\"此项选中后一经投票无法修改\">匿名投票:<input type=\"checkbox\"  {...anonymous} /></div>\n    //     <div className=\"time\"><span>截止日期:</span><input type=\"datetime-local\" {...deadline} /> </div>      \n    //     </div>\n    //   <div className=\"ensure\"><button onClick={create}>创建投票</button></div>\n    // </div>\n    _jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Divider, {\n        orientation: \"left\",\n        children: \"\\u521B\\u5EFA\\u6295\\u7968\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(List, {\n        size: \"large\",\n        header: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"Header\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 15\n        }, this),\n        footer: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"Footer\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 15\n        }, this),\n        bordered: true,\n        dataSource: options,\n        renderItem: item => /*#__PURE__*/_jsxDEV(List.Item, {\n          children: item\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 27\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true)\n  );\n}\n\n_s(CreateVote, \"IKgYBEFzbrllndr7Ivlw9J0XFTY=\", false, function () {\n  return [useInput, useInput, useInput, useBooleanInput, useNavigate, useQuery];\n});\n\n_c = CreateVote;\nexport default _c2 = forceLogin(CreateVote);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CreateVote\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/zhengwen/Desktop/vote/vote-front/src/Create-vote.js"],"names":["axios","useNavigate","produce","useInput","useQuery","useBooleanInput","forceLogin","useMemo","useState","dayjs","List","Divider","CreateVote","userInfo","options","setOptions","title","desc","deadline","add","format","anonymous","navigate","query","remove","idx","splice","setOption","val","console","log","create","vote","value","checked","multiple","get","res","post","createdVote","data","result","voteId","e","item"],"mappings":"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","sourcesContent":["//创建投票界面\nimport axios from \"axios\"\nimport { useNavigate } from \"react-router-dom\"\nimport { produce } from \"immer\"\nimport { useInput ,useQuery,useBooleanInput, forceLogin} from \"./hooks\"\nimport { useMemo, useState } from \"react\"\nimport dayjs from \"dayjs\"\n// import './create-vote.css'\nimport { List,Divider } from 'antd'\nimport 'antd/dist/antd.css';\n\n//use-immer是对useState的简单包装。不必再调produce，可以对任意数据类型进行修改\n//传给setOption的函数就是用于修改的函数§\n// import { set } from \"immer/dist/internal\"\n function CreateVote({ userInfo }){\n  var [options,setOptions] = useState(['',''])\n  var title = useInput()\n  var desc = useInput()\n  var deadline  =  useInput(useMemo(()=>dayjs().add(1,'week').format('YYYY-MM-DDTHH:mm'),[]))\n  var anonymous = useBooleanInput()\n  var navigate = useNavigate()\n  var query = useQuery()\n  function remove(idx){\n    setOptions(\n      produce( options,options =>{\n        options.splice(idx,1)\n      }\n    ))\n  }\n\n  function setOption(idx,val){\n    setOptions(\n      produce(options,options =>{\n        options[idx] = val\n      }\n    ))\n    console.log(options)\n  }\n\n async function create(){\n    var vote = {\n      title:title.value,\n      desc:desc.value,\n      options:options,\n      deadline:deadline.value,\n      anonymous:anonymous.checked,\n      multiple:query.get('multiple') === '1' ? true : false\n    }\n    console.log(vote)\n    try{\n      var res =  await axios.post('/vote',vote)\n      var createdVote = res.data.result//data里有创建好的投票信息\n      navigate(\"/view-vote/\"+createdVote.voteId)\n    }catch(e){\n      throw e\n    }\n  }\n\n\n  return(\n    // <div id=\"fa\">\n    //   <h1 style={{margin:'0 auto'}}>创建投票</h1>\n    //   <div className=\"inputs\"><input type=\"text\" placeholder=\"投票标题\" {...title}/></div>\n    //   <div className=\"inputs\"><input type=\"text\" placeholder=\"补充描述(选填)\" {...desc}/></div>\n\n    //   {\n    //     options.map((option, idx) =>\n    //       <div key={idx} className=\"inputs\">\n    //         <div>\n    //         <input className=\"option\" type=\"text\" placeholder=\"选项\" value={option} onChange={e => setOption(idx, e.target.value)}/>\n    //         <button tabIndex=\"-1\" onClick={() => remove(idx)}>×</button>\n    //         </div>\n    //       </div>\n    //     )\n    //   }\n   \n    //     <div className='bottom'>\n    //     <div> <button onClick={() => setOptions(options => [...options,''])}>添加选项</button></div>\n    //     <div className=\"any\" title=\"此项选中后一经投票无法修改\">匿名投票:<input type=\"checkbox\"  {...anonymous} /></div>\n    //     <div className=\"time\"><span>截止日期:</span><input type=\"datetime-local\" {...deadline} /> </div>      \n    //     </div>\n  \n    //   <div className=\"ensure\"><button onClick={create}>创建投票</button></div>\n    // </div>\n\n    <>\n        <Divider orientation=\"left\">创建投票</Divider>\n    <List\n      size=\"large\"\n      header={<div>Header</div>}\n      footer={<div>Footer</div>}\n      bordered\n      dataSource={options}\n      renderItem={item => <List.Item>{item}</List.Item>}\n    />\n    </>\n  )\n}\n\nexport default forceLogin(CreateVote)"]},"metadata":{},"sourceType":"module"}