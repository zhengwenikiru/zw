{"ast":null,"code":"var _jsxFileName = \"/Users/zhengwen/Desktop/vote/vote-front/src/Create-vote.js\",\n    _s = $RefreshSig$();\n\n//创建投票界面\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { produce } from \"immer\";\nimport { useInput, useQuery, useBooleanInput } from \"./hooks\";\nimport { useState } from \"react\"; //use-immer是对useState的简单包装。不必再调produce，可以对任意数据类型进行修改\n//传给setOption的函数就是用于修改的函数§\n// import { set } from \"immer/dist/internal\"\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function CreateVote() {\n  _s();\n\n  var [options, setOptions] = useState(['', '']);\n  var title = useInput();\n  var desc = useInput();\n  var anonymous = useBooleanInput();\n  var deadline = useInput();\n  var navigate = useNavigate();\n  var query = useQuery();\n\n  function remove(idx) {\n    setOptions(produce(options, options => {\n      options.splice(idx, 1);\n    }));\n  }\n\n  function setOption(idx, val) {\n    setOptions(produce(options, options => {\n      options[idx] = val;\n    }));\n    console.log(options);\n  }\n\n  async function create() {\n    var vote = {\n      title: title.value,\n      desc: desc.value,\n      options: options,\n      deadline: deadline.value,\n      anonymous: anonymous.checked,\n      multiple: query.get('multiple') === '1' ? true : false\n    };\n\n    try {\n      var res = await axios.post('/create-vote', vote);\n      var createdVote = res.data.result; //data里有创建好的投票信息\n\n      navigate(\"/vote/\" + createdVote.id);\n    } catch (e) {\n      throw e;\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"\\u521B\\u5EFA\\u6295\\u7968\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"\\u6295\\u7968\\u6807\\u9898\",\n        ...title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 12\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"\\u8865\\u5145\\u63CF\\u8FF0(\\u9009\\u586B)\",\n        ...desc\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 12\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), options.map((option, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"\\u9009\\u9879\",\n        value: option,\n        onChange: e => setOption(idx, e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        tabIndex: \"-1\",\n        onClick: () => remove(idx),\n        children: \"-\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 13\n      }, this)]\n    }, idx, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 11\n    }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setOptions(options => [...options, '']),\n        children: \"\\u6DFB\\u52A0\\u9009\\u9879\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 12\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"\\u622A\\u6B62\\u65E5\\u671F:\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"datetime-local\",\n        ...deadline\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"\\u533F\\u540D\\u6295\\u7968:\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"checkbox\",\n        ...anonymous\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: create,\n        children: \"\\u521B\\u5EFA\\u6295\\u7968\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 12\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CreateVote, \"jl/pVluM6N5BQmaH3xi54X9T2gY=\", false, function () {\n  return [useInput, useInput, useBooleanInput, useInput, useNavigate, useQuery];\n});\n\n_c = CreateVote;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateVote\");","map":{"version":3,"sources":["/Users/zhengwen/Desktop/vote/vote-front/src/Create-vote.js"],"names":["axios","useNavigate","produce","useInput","useQuery","useBooleanInput","useState","CreateVote","options","setOptions","title","desc","anonymous","deadline","navigate","query","remove","idx","splice","setOption","val","console","log","create","vote","value","checked","multiple","get","res","post","createdVote","data","result","id","e","map","option","target"],"mappings":"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","sourcesContent":["//创建投票界面\nimport axios from \"axios\"\nimport { useNavigate } from \"react-router-dom\"\nimport { produce } from \"immer\"\nimport { useInput ,useQuery,useBooleanInput} from \"./hooks\"\nimport { useState } from \"react\"\n//use-immer是对useState的简单包装。不必再调produce，可以对任意数据类型进行修改\n//传给setOption的函数就是用于修改的函数§\n// import { set } from \"immer/dist/internal\"\nexport default function CreateVote(){\n  var [options,setOptions] = useState(['',''])\n  var title = useInput()\n  var desc = useInput()\n  var anonymous = useBooleanInput()\n  var deadline  =  useInput()\n  var navigate = useNavigate()\n  var query = useQuery()\n  function remove(idx){\n    setOptions(\n      produce( options,options =>{\n        options.splice(idx,1)\n      }\n    ))\n  }\n\n  function setOption(idx,val){\n    setOptions(\n      produce(options,options =>{\n        options[idx] = val\n      }\n    ))\n    console.log(options)\n  }\n\n async function create(){\n    var vote = {\n      title:title.value,\n      desc:desc.value,\n      options:options,\n      deadline:deadline.value,\n      anonymous:anonymous.checked,\n      multiple:query.get('multiple') === '1' ? true : false\n    }\n    try{\n      var res =  await axios.post('/create-vote',vote)\n      var createdVote = res.data.result//data里有创建好的投票信息\n      navigate(\"/vote/\"+createdVote.id)\n    }catch(e){\n      throw e\n    }\n  }\n\n  return(\n    <div>\n      <h1>创建投票</h1>\n      <div><input type=\"text\" placeholder=\"投票标题\" {...title}/></div>\n      <div><input type=\"text\" placeholder=\"补充描述(选填)\" {...desc}/></div>\n\n      {\n        options.map((option, idx) =>\n          <div key={idx}>\n            <input type=\"text\" placeholder=\"选项\" value={option} onChange={e => setOption(idx, e.target.value)}/>\n            <button tabIndex=\"-1\" onClick={() => remove(idx)}>-</button>\n          </div>\n        )\n      }\n      <div><button onClick={() => setOptions(options => [...options,''])}>添加选项</button></div>\n      <div>截止日期:<input type=\"datetime-local\" {...deadline} /></div>\n      <div>匿名投票:<input type=\"checkbox\" {...anonymous} /></div>\n      <div><button onClick={create}>创建投票</button></div>\n    </div>\n  )\n}"]},"metadata":{},"sourceType":"module"}