{"ast":null,"code":"var _jsxFileName = \"/Users/zhengwen/Desktop/vote/vote-front/src/Create-vote.js\",\n    _s = $RefreshSig$();\n\n//创建投票界面\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { produce } from \"immer\";\nimport { useInput, useQuery, useBooleanInput, forceLogin } from \"./hooks\";\nimport { useMemo, useState } from \"react\";\nimport dayjs from \"dayjs\";\nimport './create-vote.css'; //use-immer是对useState的简单包装。不必再调produce，可以对任意数据类型进行修改\n//传给setOption的函数就是用于修改的函数§\n// import { set } from \"immer/dist/internal\"\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction CreateVote(_ref) {\n  _s();\n\n  let {\n    userInfo\n  } = _ref;\n  var [options, setOptions] = useState(['', '']);\n  var title = useInput();\n  var desc = useInput();\n  var deadline = useInput(useMemo(() => dayjs().add(1, 'week').format('YYYY-MM-DDTHH:mm'), []));\n  var anonymous = useBooleanInput();\n  var navigate = useNavigate();\n  var query = useQuery();\n\n  function remove(idx) {\n    setOptions(produce(options, options => {\n      options.splice(idx, 1);\n    }));\n  }\n\n  function setOption(idx, val) {\n    setOptions(produce(options, options => {\n      options[idx] = val;\n    }));\n    console.log(options);\n  }\n\n  async function create() {\n    var vote = {\n      title: title.value,\n      desc: desc.value,\n      options: options,\n      deadline: deadline.value,\n      anonymous: anonymous.checked,\n      multiple: query.get('multiple') === '1' ? true : false\n    };\n    console.log(vote);\n\n    try {\n      var res = await axios.post('/vote', vote);\n      var createdVote = res.data.result; //data里有创建好的投票信息\n\n      navigate(\"/view-vote/\" + createdVote.voteId);\n    } catch (e) {\n      throw e;\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"fa\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      style: {\n        margin: '0 auto'\n      },\n      children: \"\\u521B\\u5EFA\\u6295\\u7968\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inputs\",\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"\\u6295\\u7968\\u6807\\u9898\",\n        ...title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 31\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inputs\",\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"\\u8865\\u5145\\u63CF\\u8FF0(\\u9009\\u586B)\",\n        ...desc\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 31\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), options.map((option, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inputs\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"option\",\n          type: \"text\",\n          placeholder: \"\\u9009\\u9879\",\n          value: option,\n          onChange: e => setOption(idx, e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          tabIndex: \"-1\",\n          onClick: () => remove(idx),\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 13\n      }, this)\n    }, idx, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 11\n    }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inputs\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setOptions(options => [...options, '']),\n            children: \"\\u6DFB\\u52A0\\u9009\\u9879\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"time\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u622A\\u6B62\\u65E5\\u671F:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 31\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"datetime-local\",\n            ...deadline\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 49\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"any\",\n      title: \"\\u6B64\\u9879\\u9009\\u4E2D\\u540E\\u4E00\\u7ECF\\u6295\\u7968\\u65E0\\u6CD5\\u4FEE\\u6539\",\n      children: [\"\\u533F\\u540D\\u6295\\u7968:\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"checkbox\",\n        ...anonymous\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 55\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ensure\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: create,\n        children: \"\\u521B\\u5EFA\\u6295\\u7968\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 31\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CreateVote, \"IKgYBEFzbrllndr7Ivlw9J0XFTY=\", false, function () {\n  return [useInput, useInput, useInput, useBooleanInput, useNavigate, useQuery];\n});\n\n_c = CreateVote;\nexport default _c2 = forceLogin(CreateVote);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CreateVote\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/zhengwen/Desktop/vote/vote-front/src/Create-vote.js"],"names":["axios","useNavigate","produce","useInput","useQuery","useBooleanInput","forceLogin","useMemo","useState","dayjs","CreateVote","userInfo","options","setOptions","title","desc","deadline","add","format","anonymous","navigate","query","remove","idx","splice","setOption","val","console","log","create","vote","value","checked","multiple","get","res","post","createdVote","data","result","voteId","e","margin","map","option","target"],"mappings":"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","sourcesContent":["//创建投票界面\nimport axios from \"axios\"\nimport { useNavigate } from \"react-router-dom\"\nimport { produce } from \"immer\"\nimport { useInput ,useQuery,useBooleanInput, forceLogin} from \"./hooks\"\nimport { useMemo, useState } from \"react\"\nimport dayjs from \"dayjs\"\nimport './create-vote.css'\n\n//use-immer是对useState的简单包装。不必再调produce，可以对任意数据类型进行修改\n//传给setOption的函数就是用于修改的函数§\n// import { set } from \"immer/dist/internal\"\n function CreateVote({ userInfo }){\n  var [options,setOptions] = useState(['',''])\n  var title = useInput()\n  var desc = useInput()\n  var deadline  =  useInput(useMemo(()=>dayjs().add(1,'week').format('YYYY-MM-DDTHH:mm'),[]))\n  var anonymous = useBooleanInput()\n  var navigate = useNavigate()\n  var query = useQuery()\n  function remove(idx){\n    setOptions(\n      produce( options,options =>{\n        options.splice(idx,1)\n      }\n    ))\n  }\n\n  function setOption(idx,val){\n    setOptions(\n      produce(options,options =>{\n        options[idx] = val\n      }\n    ))\n    console.log(options)\n  }\n\n async function create(){\n    var vote = {\n      title:title.value,\n      desc:desc.value,\n      options:options,\n      deadline:deadline.value,\n      anonymous:anonymous.checked,\n      multiple:query.get('multiple') === '1' ? true : false\n    }\n    console.log(vote)\n    try{\n      var res =  await axios.post('/vote',vote)\n      var createdVote = res.data.result//data里有创建好的投票信息\n      navigate(\"/view-vote/\"+createdVote.voteId)\n    }catch(e){\n      throw e\n    }\n  }\n\n\n  return(\n    <div id=\"fa\">\n      <h1 style={{margin:'0 auto'}}>创建投票</h1>\n      <div className=\"inputs\"><input type=\"text\" placeholder=\"投票标题\" {...title}/></div>\n      <div className=\"inputs\"><input type=\"text\" placeholder=\"补充描述(选填)\" {...desc}/></div>\n\n      {\n        options.map((option, idx) =>\n          <div key={idx} className=\"inputs\">\n            <div>\n            <input className=\"option\" type=\"text\" placeholder=\"选项\" value={option} onChange={e => setOption(idx, e.target.value)}/>\n            <button tabIndex=\"-1\" onClick={() => remove(idx)}>×</button>\n            </div>\n          </div>\n        )\n      }\n      <div className=\"inputs\">\n        <div>\n        <div> <button onClick={() => setOptions(options => [...options,''])}>添加选项</button></div>\n        <div className=\"time\"><span>截止日期:</span><input type=\"datetime-local\" {...deadline} /> </div>\n        </div>\n        </div>\n      <div className=\"any\" title=\"此项选中后一经投票无法修改\">匿名投票:<input type=\"checkbox\"  {...anonymous} /></div>\n      <div className=\"ensure\"><button onClick={create}>创建投票</button></div>\n    </div>\n  )\n}\n\nexport default forceLogin(CreateVote)"]},"metadata":{},"sourceType":"module"}