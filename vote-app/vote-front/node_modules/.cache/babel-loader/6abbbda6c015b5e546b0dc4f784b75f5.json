{"ast":null,"code":"var _jsxFileName = \"/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Create-vote.js\",\n    _s = $RefreshSig$();\n\n//创建投票界面\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { produce } from \"immer\";\nimport { useInput, useQuery, useBooleanInput, forceLogin } from \"./hooks\";\nimport { useMemo, useState } from \"react\";\nimport dayjs from \"dayjs\";\nimport './create-vote.css';\nimport { Divider, Button } from 'antd';\nimport 'antd/dist/antd.css'; //use-immer是对useState的简单包装。不必再调produce，可以对任意数据类型进行修改\n//传给setOption的函数就是用于修改的函数§\n// import { set } from \"immer/dist/internal\"\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction CreateVote(_ref) {\n  _s();\n\n  let {\n    userInfo\n  } = _ref;\n  var [options, setOptions] = useState(['', '']);\n  var title = useInput();\n  var desc = useInput();\n  var deadline = useInput(useMemo(() => dayjs().add(1, 'week').format('YYYY-MM-DDTHH:mm'), []));\n  var anonymous = useBooleanInput();\n  var navigate = useNavigate();\n  var query = useQuery();\n\n  function remove(idx) {\n    setOptions(produce(options, options => {\n      options.splice(idx, 1);\n    }));\n  }\n\n  function setOption(idx, val) {\n    setOptions(produce(options, options => {\n      options[idx] = val;\n    })); // console.log(options)\n  }\n\n  async function create() {\n    var vote = {\n      title: title.value,\n      desc: desc.value,\n      options: options,\n      deadline: deadline.value,\n      anonymous: anonymous.checked,\n      multiple: query.get('multiple') === '1' ? true : false\n    }; // console.log(vote)\n\n    try {\n      var res = await axios.post('/vote', vote);\n      var createdVote = res.data.result; //data里有创建好的投票信息\n\n      navigate(\"/view-vote/\" + createdVote.voteId);\n    } catch (e) {\n      throw e;\n    }\n  }\n\n  return (\n    /*#__PURE__*/\n    // <div id=\"fa\">\n    //   <h1 style={{margin:'0 auto'}}>创建投票</h1>\n    //   <div className=\"inputs\"><input type=\"text\" placeholder=\"投票标题\" {...title}/></div>\n    //   <div className=\"inputs\"><input type=\"text\" placeholder=\"补充描述(选填)\" {...desc}/></div>\n    //   {\n    //     options.map((option, idx) =>\n    //       <div key={idx} className=\"inputs\">\n    //         <div>\n    //         <input className=\"option\" type=\"text\" placeholder=\"选项\" value={option} onChange={e => setOption(idx, e.target.value)}/>\n    //         <button tabIndex=\"-1\" onClick={() => remove(idx)}>×</button>\n    //         </div>\n    //       </div>\n    //     )\n    //   }\n    //     <div className='bottom'>\n    //     <div> <button onClick={() => setOptions(options => [...options,''])}>添加选项</button></div>\n    //     <div className=\"any\" title=\"此项选中后一经投票无法修改\">匿名投票:<input type=\"checkbox\"  {...anonymous} /></div>\n    //     <div className=\"time\"><span>截止日期:</span><input type=\"datetime-local\" {...deadline} /> </div>      \n    //     </div>\n    //   <div className=\"ensure\"><button onClick={create}>创建投票</button></div>\n    // </div>\n    _jsxDEV(\"div\", {\n      id: \"crvo\",\n      children: [/*#__PURE__*/_jsxDEV(Divider, {\n        orientation: \"left\",\n        children: \"\\u521B\\u5EFA\\u6295\\u7968\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tt\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"\\u6295\\u7968\\u6807\\u9898\",\n          ...title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 27\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tt\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"\\u8865\\u5145\\u63CF\\u8FF0(\\u9009\\u586B)\",\n          ...desc\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 27\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"ol\", {\n        children: options.map((option, idx) => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              spellCheck: \"false\",\n              type: \"text\",\n              placeholder: \"\\u9009\\u9879\",\n              value: option,\n              onChange: e => setOption(idx, e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 96,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              tabIndex: \"-1\",\n              onClick: () => remove(idx),\n              children: \"\\u5220\\u9664\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 13\n          }, this)\n        }, idx, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bottom\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"add\",\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setOptions(options => [...options, '']),\n            children: \"\\u6DFB\\u52A0\\u9009\\u9879\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 31\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"any\",\n          title: \"\\u6B64\\u9879\\u9009\\u4E2D\\u540E\\u4E00\\u7ECF\\u6295\\u7968\\u65E0\\u6CD5\\u4FEE\\u6539\",\n          children: [\" \\u533F\\u540D\\u6295\\u7968: \", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            ...anonymous\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 59\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"time\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u622A\\u6B62\\u65E5\\u671F:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 31\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"datetime-local\",\n            ...deadline\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 49\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sub\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          size: \"large\",\n          onClick: create,\n          children: \"\\u521B\\u5EFA\\u6295\\u7968\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 28\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 5\n    }, this)\n  );\n}\n\n_s(CreateVote, \"IKgYBEFzbrllndr7Ivlw9J0XFTY=\", false, function () {\n  return [useInput, useInput, useInput, useBooleanInput, useNavigate, useQuery];\n});\n\n_c = CreateVote;\nexport default _c2 = forceLogin(CreateVote);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CreateVote\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Create-vote.js"],"names":["axios","useNavigate","produce","useInput","useQuery","useBooleanInput","forceLogin","useMemo","useState","dayjs","Divider","Button","CreateVote","userInfo","options","setOptions","title","desc","deadline","add","format","anonymous","navigate","query","remove","idx","splice","setOption","val","create","vote","value","checked","multiple","get","res","post","createdVote","data","result","voteId","e","map","option","target"],"mappings":"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","sourcesContent":["//创建投票界面\nimport axios from \"axios\"\nimport { useNavigate } from \"react-router-dom\"\nimport { produce } from \"immer\"\nimport { useInput ,useQuery,useBooleanInput, forceLogin} from \"./hooks\"\nimport { useMemo, useState } from \"react\"\nimport dayjs from \"dayjs\"\nimport './create-vote.css'\nimport { Divider,Button} from 'antd'\nimport 'antd/dist/antd.css';\n\n//use-immer是对useState的简单包装。不必再调produce，可以对任意数据类型进行修改\n//传给setOption的函数就是用于修改的函数§\n// import { set } from \"immer/dist/internal\"\n function CreateVote({ userInfo }){\n  var [options,setOptions] = useState(['',''])\n  var title = useInput()\n  var desc = useInput()\n  var deadline  =  useInput(useMemo(()=>dayjs().add(1,'week').format('YYYY-MM-DDTHH:mm'),[]))\n  var anonymous = useBooleanInput()\n  var navigate = useNavigate()\n  var query = useQuery()\n  function remove(idx){\n    setOptions(\n      produce( options,options =>{\n        options.splice(idx,1)\n      }\n    ))\n  }\n\n  function setOption(idx,val){\n    setOptions(\n      produce(options,options =>{\n        options[idx] = val\n      }\n    ))\n    // console.log(options)\n  }\n\n async function create(){\n    var vote = {\n      title:title.value,\n      desc:desc.value,\n      options:options,\n      deadline:deadline.value,\n      anonymous:anonymous.checked,\n      multiple:query.get('multiple') === '1' ? true : false\n    }\n    // console.log(vote)\n    try{\n      var res =  await axios.post('/vote',vote)\n      var createdVote = res.data.result//data里有创建好的投票信息\n      navigate(\"/view-vote/\"+createdVote.voteId)\n    }catch(e){\n      throw e\n    }\n  }\n\n\n  return(\n    // <div id=\"fa\">\n    //   <h1 style={{margin:'0 auto'}}>创建投票</h1>\n    //   <div className=\"inputs\"><input type=\"text\" placeholder=\"投票标题\" {...title}/></div>\n    //   <div className=\"inputs\"><input type=\"text\" placeholder=\"补充描述(选填)\" {...desc}/></div>\n\n    //   {\n    //     options.map((option, idx) =>\n    //       <div key={idx} className=\"inputs\">\n    //         <div>\n    //         <input className=\"option\" type=\"text\" placeholder=\"选项\" value={option} onChange={e => setOption(idx, e.target.value)}/>\n    //         <button tabIndex=\"-1\" onClick={() => remove(idx)}>×</button>\n    //         </div>\n    //       </div>\n    //     )\n    //   }\n   \n    //     <div className='bottom'>\n    //     <div> <button onClick={() => setOptions(options => [...options,''])}>添加选项</button></div>\n    //     <div className=\"any\" title=\"此项选中后一经投票无法修改\">匿名投票:<input type=\"checkbox\"  {...anonymous} /></div>\n    //     <div className=\"time\"><span>截止日期:</span><input type=\"datetime-local\" {...deadline} /> </div>      \n    //     </div>\n  \n    //   <div className=\"ensure\"><button onClick={create}>创建投票</button></div>\n    // </div>\n\n    <div id=\"crvo\">\n        <Divider orientation=\"left\">创建投票</Divider>\n   \n      <div className=\"tt\"><input type=\"text\" placeholder=\"投票标题\" {...title}/></div>\n      <div className=\"tt\"><input type=\"text\" placeholder=\"补充描述(选填)\" {...desc}/></div>\n    <ol>\n      {\n        options.map((option, idx) =>\n          <li key={idx} >\n            <div>\n            <input  spellCheck=\"false\" type=\"text\" placeholder=\"选项\" value={option} onChange={e => setOption(idx, e.target.value)}/>\n            <button tabIndex=\"-1\" onClick={() => remove(idx)}>删除</button>\n            </div>\n          </li>\n        )\n      }   \n    </ol>\n\n       <div className='bottom'>\n        <div className=\"add\"> <button onClick={() => setOptions(options => [...options,''])}>添加选项</button></div>\n        <div className=\"any\" title=\"此项选中后一经投票无法修改\"> 匿名投票: <input  type=\"checkbox\"  {...anonymous} /></div>\n        <div className=\"time\"><span>截止日期:</span><input type=\"datetime-local\" {...deadline} /> </div>      \n       </div>\n  \n      <div className=\"sub\"><Button size='large'  onClick={create}>创建投票</Button></div>\n    \n    </div>\n  )\n}\n\nexport default forceLogin(CreateVote)"]},"metadata":{},"sourceType":"module"}