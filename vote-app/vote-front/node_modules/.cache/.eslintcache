[{"/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/index.js":"1","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/App.js":"2","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Register.js":"3","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Main.js":"4","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Login.js":"5","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/CurrentUserInfo.js":"6","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/ViewVote.js":"7","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Create-vote.js":"8","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Create.js":"9","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Myvotes.js":"10","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/hooks.js":"11","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/RequireLogin.js":"12"},{"size":221,"mtime":1647914819283,"results":"13","hashOfConfig":"14"},{"size":1006,"mtime":1648024784507,"results":"15","hashOfConfig":"14"},{"size":1385,"mtime":1649315261823,"results":"16","hashOfConfig":"14"},{"size":6863,"mtime":1649592730401,"results":"17","hashOfConfig":"14"},{"size":1296,"mtime":1649314445124,"results":"18","hashOfConfig":"14"},{"size":434,"mtime":1647830111301,"results":"19","hashOfConfig":"14"},{"size":5975,"mtime":1649640900929,"results":"20","hashOfConfig":"14"},{"size":4316,"mtime":1649592385748,"results":"21","hashOfConfig":"14"},{"size":636,"mtime":1648024932899,"results":"22","hashOfConfig":"14"},{"size":991,"mtime":1649638012018,"results":"23","hashOfConfig":"14"},{"size":2581,"mtime":1649592726380,"results":"24","hashOfConfig":"14"},{"size":184,"mtime":1647770862952,"results":"25","hashOfConfig":"14"},{"filePath":"26","messages":"27","suppressedMessages":"28","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"az8cz4",{"filePath":"29","messages":"30","suppressedMessages":"31","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"32","messages":"33","suppressedMessages":"34","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"36","messages":"37","suppressedMessages":"38","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"39","usedDeprecatedRules":"40"},{"filePath":"41","messages":"42","suppressedMessages":"43","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"44","messages":"45","suppressedMessages":"46","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"47","messages":"48","suppressedMessages":"49","errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"50"},{"filePath":"51","messages":"52","suppressedMessages":"53","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"54","usedDeprecatedRules":"40"},{"filePath":"55","messages":"56","suppressedMessages":"57","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"58","messages":"59","suppressedMessages":"60","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"61","messages":"62","suppressedMessages":"63","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"64","usedDeprecatedRules":"40"},{"filePath":"65","messages":"66","suppressedMessages":"67","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/index.js",[],[],"/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/App.js",[],[],"/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Register.js",[],[],["68","69"],"/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Main.js",["70","71","72"],[],"import { NavLink,Link, Outlet, useNavigate } from \"react-router-dom\";\nimport './main.css'\nimport { Avatar, Button} from 'antd'\nimport { UserOutlined  ,FormOutlined} from '@ant-design/icons';\nimport 'antd/dist/antd.css';\nimport { useEffect } from \"react\";\nimport axios from \"axios\";\nexport default function Main(){\n  var navigate = useNavigate()\n  useEffect(()=>{\n    var labels = document.querySelectorAll('label')\n    labels.forEach(label=>{\n      label.addEventListener('click',()=>{\n        label.children[0].checked = true   \n        label.children[2].click()\n      })\n    })\n  },[])\n async function logout(){\n    try{     \n      var res =await axios.get('/account/logout')\n      navigate('/')\n      window.location.reload()\n      //\n    }catch(e){\n      throw e\n    }\n  }\n\n  return(\n    <div className=\"shell\">\n      <header>\n        <img style={{width:'60px',height:'60px'}} src=\"data:image/png;base64,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\" />\n       <span style={{textAlign:'center',fontSize:'30px'}}> 投票 </span>\n       <div className=\"avatar\"><Button type=\"primary\" shape=\"round\" onClick={logout} className='logout'>登出</Button></div>\n     \n      </header>\n      <div className=\"container\">\n      <aside>       \n      <label htmlFor=\"option1\" > \n        <input type='radio' id='option1' name=\"option\" defaultChecked />\n        <FormOutlined/>\n        <Link to=\"/main/create\">新建投票</Link>\n      </label>\n      <label htmlFor=\"option2\">\n        <input type='radio' id='option2' name=\"option\"/>\n          <Avatar size={18} icon={<UserOutlined />} />\n        <Link to=\"/main/myvotes\">我的投票</Link> \n      </label>\n      </aside>\n      <main>\n        <Outlet/> \n      </main>\n     </div>\n    </div>\n  )\n}\n",["73","74"],"/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Login.js",[],[],"/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/CurrentUserInfo.js",[],[],"/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/ViewVote.js",["75","76","77","78","79","80","81","82"],[],"// 投票查看及交互页面\nimport { useParams,useNavigate } from \"react-router-dom\"\nimport axios from \"axios\"\nimport { useEffect, useState, useMemo } from \"react\"\nimport { forceLogin, useAxios } from './hooks'\nimport './ViewVote.css'\nimport _ from 'lodash'\nimport dayjs from 'dayjs'\nimport { useImmer } from \"use-immer\"\nimport{ Button,Divider,Progress } from 'antd'\nimport 'antd/dist/antd.css';\nimport { ArrowLeftOutlined } from \"@ant-design/icons\"\n\n\n\n\n/**\n * 投票页面的信息是实时更新的\n * 实现这个需求有两种方案：\n * 一是页面加载成功后一直不断的发ajax请求来获取最新的数据，并展示出来\n *  这种做法在投票已经创建出很久以后就不够好了，因为如果创建出很久以后，大概率是不会更新的\n *  发出请求大概率是没有获取到最新信息的\n * 第二种方案为http长连接，也叫comet，即服务器在收到客户端发来的ajax请求后\n *  如果没有数据要回复给客户端，则服务器hold住这个连接，直到超时后响应空内容，或在有数据后立刻响应该请求\n *    微信/钉钉的登陆都是这个方案\n * 第三种：websocket\n *  页面加载成功后向服务器建立一个websocket连接，如果服务器有新的数据，则直接在这个ws连接上响应客户端\n *    而不用客户端主动的一直发请求\n *\n *\n *\n */\nfunction ViewVote({ userInfo }) {\n  var { voteId } = useParams()\n  var { loading, data, error, update } = useAxios({ url: `/vote/${voteId}` })\n  var [userVotes, setUserVotes] = useState() // 从websocket上获取到的实时信息\n  var [selectedOptionIds, setSelectedOptionIds] = useImmer([])\n  var navigate = useNavigate()\n  useEffect(() => {\n    // 如果还在加载，或者是超过截止时间，则什么也不做\n    if (loading || Date.now() > new Date(data.vote.deadline).getTime()) {\n      return\n    }\n    var wsUrl = `${window.location.protocol.replace('http', 'ws')}//${window.location.host}/realtime-voteinfo/${voteId}`\n    var ws = new WebSocket(wsUrl)\n    // 实时接受服务器发来的最新消息\n    ws.onmessage = function (e) {\n      var data = JSON.parse(e.data)\n      console.log(data)\n      setUserVotes(data)\n    }\n    return () => ws.close()\n  //组件销毁时关闭ws连接\n  }, [loading, voteId])\n\n  // 为某个选项投票/或取消投票\n  async function voteOption(option) {\n    if (!data.vote.anonymous) {\n      var { optionId } = option\n      await axios.post(`/vote/${voteId}`, {\n        optionIds: [optionId]\n      })\n    } else { // 匿名的话，发选中的\n      await axios.post(`/vote/${voteId}`, {\n        optionIds: selectedOptionIds\n      })\n      setSelectedOptionIds([])\n    }\n  }\n\n  function selectOption(option) {\n    var { optionId } = option\n    if (selectedOptionIds.includes(optionId)) {\n      setSelectedOptionIds(selectedOptionIds => {\n        var idx = selectedOptionIds.indexOf(optionId)\n        selectedOptionIds.splice(idx, 1)\n      })\n    } else {\n      setSelectedOptionIds(selectedOptionIds => {\n        selectedOptionIds.push(optionId)\n      })\n    }\n  }\n\n  function handleOptionClick(option) {\n    if (data.vote.anonymous) {\n      if (votes.some(it => it.userId === userInfo.data.userId)) {\n        return\n      }//匿名则是选中选项\n      selectOption(option)\n    } else {//公开\n      voteOption(option)\n    }\n  }\n\n  var votes = userVotes ?? data?.userVotes ?? []\n//从当前用户的\n  var groupedVotes    = useMemo(() => _.groupBy(votes, 'optionId'), [votes])//用投票选项ID分组,\n  //{optionId:[]}\n  var uniqueUserCount = useMemo(() => _.uniqBy(votes, 'userId').length, [votes]) // 去掉同用户投票后的数量,即选项有多少人投了\n\n\n  if (loading) return 'Loading...'\n\n  return (\n    <div className=\"vv\">\n            <Button style={{float:'left'}} type=\"primary\" shape=\"round\" icon={<ArrowLeftOutlined/>} onClick={()=>navigate(-1)} />\n         <Divider orientation=\"left\"><h2>投票标题:{data.vote.title}</h2></Divider>\n      <span style={{color: '#3269da'}}>[{data.vote.multiple ? '多选' : '单选'}](多投只取第一个)</span>\n      <span style={{color: '#3269da'}}>[{data.vote.anonymous ? '匿名' : '公开'}]</span>\n      <div className=\"voteinfo\">\n    \n      <h3>描述:{data.vote.desc}</h3>\n      <ol>\n        {\n          data.options.map(option => {\n           //option是每个选项\n            var thisOptionVotes = groupedVotes[option.optionId] || []\n\n            return (\n              <li onClick={() => handleOptionClick(option)} key={option.optionId}>\n                {option.content}\n                (票数:{thisOptionVotes.length})\n                {thisOptionVotes.some(it => it.userId == userInfo.data.userId) ? '✔️' : ''}\n                <div style={{width:'170px'}}>\n                <Progress size=\"small\" percent={uniqueUserCount == 0 ? 0 : (thisOptionVotes.length / uniqueUserCount * 100).toFixed(2)}/>\n                </div>\n                {/* [{uniqueUserCount == 0 ? 0 : (thisOptionVotes.length / uniqueUserCount * 100).toFixed(2)}%] */}\n\n                {/* 当选选项的任意一票是当前登陆用户，则说明当前用户已经选择该选项 */}\n\n                {selectedOptionIds.includes(option.optionId) ? '✔️' : ''}\n\n                <div/>\n                {\n                  thisOptionVotes.map(oneVote => {\n                    return <span key={oneVote.userId} className=\"user-id\">{oneVote.userId}</span>\n                  })\n                }\n              </li>\n            )\n          })\n        }\n      </ol>\n\n      {/* 匿名且当前用户没投过才显示确定投票按钮 */}\n      {!!data.vote.anonymous && !votes.some(it => it.userId == userInfo.data.userId) &&\n        <Button disabled={!selectedOptionIds.length} onClick={voteOption}>确定投票</Button>\n      }\n\n      <p>投票截止日期:{dayjs(data.vote.deadline).format('YYYY-MM-DD HH:mm')}</p>\n      </div>\n     \n    </div>\n  )\n}\n\nexport default forceLogin(ViewVote)\n","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Create-vote.js",["83","84"],[],"//创建投票界面\nimport axios from \"axios\"\nimport { useNavigate } from \"react-router-dom\"\nimport { produce } from \"immer\"\nimport { useInput ,useQuery,useBooleanInput, forceLogin} from \"./hooks\"\nimport { useEffect, useMemo, useState } from \"react\"\nimport dayjs from \"dayjs\"\nimport './create-vote.css'\nimport { Divider,Button,Input,Tooltip} from 'antd'\nimport 'antd/dist/antd.css';\nimport { ArrowLeftOutlined } from \"@ant-design/icons\"\n\n//use-immer是对useState的简单包装。不必再调produce，可以对任意数据类型进行修改\n//传给setOption的函数就是用于修改的函数§\n// import { set } from \"immer/dist/internal\"\n function CreateVote({ userInfo }){\n  var [options,setOptions] = useState(['',''])\n  var title = useInput()\n  var desc = useInput()\n  var deadline  =  useInput(useMemo(()=>dayjs().add(1,'week').format('YYYY-MM-DDTHH:mm'),[]))\n  var anonymous = useBooleanInput()\n  var navigate = useNavigate()\n  var query = useQuery()\n  function remove(idx){\n    setOptions(\n      produce( options,options =>{\n        options.splice(idx,1)\n      }\n    ))\n  }\n\n  function setOption(idx,val){\n    setOptions(\n      produce(options,options =>{\n        options[idx] = val\n      }\n    ))\n    // console.log(options)\n  }\n\n async function create(){\n    var vote = {\n      title:title.value,\n      desc:desc.value,\n      options:options,\n      deadline:deadline.value,\n      anonymous:anonymous.checked,\n      multiple:query.get('multiple') === '1' ? true : false\n    }\n    // console.log(vote)\n    try{\n      var res =  await axios.post('/vote',vote)\n      var createdVote = res.data.result//data里有创建好的投票信息\n      navigate(\"/view-vote/\"+createdVote.voteId)\n    }catch(e){\n      throw e\n    }\n  }\n\n\n\n  return(\n    // <div id=\"fa\">\n    //   <h1 style={{margin:'0 auto'}}>创建投票</h1>\n    //   <div className=\"inputs\"><input type=\"text\" placeholder=\"投票标题\" {...title}/></div>\n    //   <div className=\"inputs\"><input type=\"text\" placeholder=\"补充描述(选填)\" {...desc}/></div>\n\n    //   {\n    //     options.map((option, idx) =>\n    //       <div key={idx} className=\"inputs\">\n    //         <div>\n    //         <input className=\"option\" type=\"text\" placeholder=\"选项\" value={option} onChange={e => setOption(idx, e.target.value)}/>\n    //         <button tabIndex=\"-1\" onClick={() => remove(idx)}>×</button>\n    //         </div>\n    //       </div>\n    //     )\n    //   }\n   \n    //     <div className='bottom'>\n    //     <div> <button onClick={() => setOptions(options => [...options,''])}>添加选项</button></div>\n    //     <div className=\"any\" title=\"此项选中后一经投票无法修改\">匿名投票:<input type=\"checkbox\"  {...anonymous} /></div>\n    //     <div className=\"time\"><span>截止日期:</span><input type=\"datetime-local\" {...deadline} /> </div>      \n    //     </div>\n  \n    //   <div className=\"ensure\"><button onClick={create}>创建投票</button></div>\n    // </div>\n\n    <div id=\"crvo\">\n      <Button style={{float:'left'}} type=\"primary\" shape=\"round\" icon={<ArrowLeftOutlined/>} onClick={()=>navigate(-1)} />\n        <Divider orientation=\"left\">创建投票</Divider>\n   \n      <div className=\"tt\"><Input type=\"text\" placeholder=\"投票标题\" {...title}/></div>\n      <div className=\"tt\"><Input type=\"text\" placeholder=\"补充描述(选填)\" {...desc}/></div>\n    <ul>\n      {\n        options.map((option, idx) =>\n          <li key={idx} >\n            <div>\n            <Input  spellCheck=\"false\" type=\"text\" placeholder=\"选项\" value={option} onChange={e => setOption(idx, e.target.value)}/>\n            <button tabIndex=\"-1\" onClick={() => remove(idx)}>删除</button>\n            </div>\n          </li>\n        )\n      }   \n    </ul>\n\n       <div className='bottom'>\n        <div className=\"any\" title=\"此项选中后一经投票无法修改\"> 匿名投票: <input  type=\"checkbox\"  {...anonymous} /></div>\n        <div className=\"add\"> <button onClick={() => setOptions(options => [...options,''])}>添加选项</button></div>\n        <div className=\"time\"><span>截止日期:</span><input type=\"datetime-local\" {...deadline} /> </div>      \n       </div>\n  \n      <div className=\"sub\"><Button size='large'  onClick={create}>创建投票</Button></div>\n    \n    </div>\n  )\n}\n\nexport default forceLogin(CreateVote)","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Create.js",[],[],"/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/Myvotes.js",["85","86"],[],"/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/hooks.js",["87","88"],[],"import { useCallback,useState ,useMemo,useEffect, useContext} from \"react\"\nimport { useLocation } from \"react-router-dom\"\nimport{ UserContext } from './CurrentUserInfo'\nimport axios from \"axios\"\nimport RequireLogin from './RequireLogin'\n\n\nexport function useInput(init=''){\n  var [value,setValue] = useState(init)\n  var onChange = useCallback(function onChange(e){\n      setValue(e.target.value)\n  },[])\n  return{\n    value,onChange\n  }\n}\n\nexport function useBooleanInput(init = false){\n  var [checked,setChecked] = useState(init)\n  var onChange = useCallback(function onChange(e){\n    setChecked(e.target.checked)\n  },[])\n  return {\n    checked,onChange\n  }\n}\n\nexport function useQuery(){\n  var search = useLocation().search\n  return useMemo(()=>new URLSearchParams(search),[search])\n}\n//从url中获取?后面的部分\n\n\nexport function useAxios(config) {\n  var [data, setData] = useState() // 用来存放请求结果的\n  var [error, setError] = useState() // 用来存放错误结果的\n  var [loading, setLoading] = useState(true) // 用来存放是否还在加载中\n  var [i, setI] = useState(0)\n\n  useEffect(() => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n\n    var req = axios({\n      ...config,\n      cancelToken: source.token\n    })\n\n    req.then(res => {\n      if (res.data.code == 0) {\n        setData(res.data.result)\n        setError(null)\n      } else {\n        setError(res.data.msg)\n      }\n      setLoading(false)\n    }).catch(e => {\n      setError(e.toString())\n      setLoading(false)\n    })\n//返回的函数在组件销毁后执行，即关闭axios请求\n    return () => source.cancel()\n  }, [config.url, i])\n\n  var update = useCallback(function update() {\n    setLoading(true)\n    setI(i => i + 1)\n  }, [])\n  return {\n    data,\n    loading,\n    error,\n    update,\n  }\n}\n\n//拿到当前登陆用户的业务Hook\nexport function useUser(){\n  return useContext(UserContext)\n  //拿到CurentUserInfo文件中 UserContext.Provider传的 userInfo的信息\n}\n\n\n//强制登陆的高阶组件，用它包裹的组件必须登陆才能显示,view-vote,creat-vote,my-votes\n  export function forceLogin(Comp){\n    function ForceLoginComp(props){\n      var userInfo = useUser()\n      if(userInfo.loading){\n        return  null\n      }\n      if(userInfo.error){\n        return <RequireLogin />\n      }\n      return <Comp {...props} userInfo = {userInfo}  />\n      //把forceLogin组件的props传给comp组件\n    }\n\n    ForceLoginComp.displayName = 'ForceLogin' +(Comp.displayName ?? Comp.name)\n\n    return ForceLoginComp\n  }","/Users/zhengwen/Desktop/zw/vote-app/vote-front/src/RequireLogin.js",[],[],{"ruleId":"89","replacedBy":"90"},{"ruleId":"91","replacedBy":"92"},{"ruleId":"93","severity":1,"message":"94","line":1,"column":10,"nodeType":"95","messageId":"96","endLine":1,"endColumn":17},{"ruleId":"93","severity":1,"message":"97","line":21,"column":11,"nodeType":"95","messageId":"96","endLine":21,"endColumn":14},{"ruleId":"98","severity":1,"message":"99","line":33,"column":9,"nodeType":"100","endLine":33,"endColumn":5254},{"ruleId":"89","replacedBy":"101"},{"ruleId":"91","replacedBy":"102"},{"ruleId":"93","severity":1,"message":"103","line":35,"column":24,"nodeType":"95","messageId":"96","endLine":35,"endColumn":29},{"ruleId":"93","severity":1,"message":"104","line":35,"column":31,"nodeType":"95","messageId":"96","endLine":35,"endColumn":37},{"ruleId":"105","severity":1,"message":"106","line":54,"column":6,"nodeType":"107","endLine":54,"endColumn":23,"suggestions":"108"},{"ruleId":"105","severity":1,"message":"109","line":96,"column":7,"nodeType":"110","endLine":96,"endColumn":49},{"ruleId":"105","severity":1,"message":"111","line":96,"column":7,"nodeType":"110","endLine":96,"endColumn":49},{"ruleId":"112","severity":1,"message":"113","line":124,"column":55,"nodeType":"114","messageId":"115","endLine":124,"endColumn":57},{"ruleId":"112","severity":1,"message":"113","line":126,"column":65,"nodeType":"114","messageId":"115","endLine":126,"endColumn":67},{"ruleId":"112","severity":1,"message":"113","line":147,"column":61,"nodeType":"114","messageId":"115","endLine":147,"endColumn":63},{"ruleId":"93","severity":1,"message":"116","line":6,"column":10,"nodeType":"95","messageId":"96","endLine":6,"endColumn":19},{"ruleId":"93","severity":1,"message":"117","line":9,"column":31,"nodeType":"95","messageId":"96","endLine":9,"endColumn":38},{"ruleId":"93","severity":1,"message":"103","line":6,"column":22,"nodeType":"95","messageId":"96","endLine":6,"endColumn":27},{"ruleId":"93","severity":1,"message":"104","line":6,"column":28,"nodeType":"95","messageId":"96","endLine":6,"endColumn":34},{"ruleId":"112","severity":1,"message":"113","line":51,"column":25,"nodeType":"114","messageId":"115","endLine":51,"endColumn":27},{"ruleId":"105","severity":1,"message":"118","line":64,"column":6,"nodeType":"107","endLine":64,"endColumn":21,"suggestions":"119"},"no-native-reassign",["120"],"no-negated-in-lhs",["121"],"no-unused-vars","'NavLink' is defined but never used.","Identifier","unusedVar","'res' is assigned a value but never used.","jsx-a11y/alt-text","img elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","JSXOpeningElement",["120"],["121"],"'error' is assigned a value but never used.","'update' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'data.vote.deadline'. Either include it or remove the dependency array.","ArrayExpression",["122"],"The 'votes' logical expression could make the dependencies of useMemo Hook (at line 98) change on every render. To fix this, wrap the initialization of 'votes' in its own useMemo() Hook.","VariableDeclarator","The 'votes' logical expression could make the dependencies of useMemo Hook (at line 100) change on every render. To fix this, wrap the initialization of 'votes' in its own useMemo() Hook.","eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","'useEffect' is defined but never used.","'Tooltip' is defined but never used.","React Hook useEffect has a missing dependency: 'config'. Either include it or remove the dependency array.",["123"],"no-global-assign","no-unsafe-negation",{"desc":"124","fix":"125"},{"desc":"126","fix":"127"},"Update the dependencies array to be: [data.vote.deadline, loading, voteId]",{"range":"128","text":"129"},"Update the dependencies array to be: [config, config.url, i]",{"range":"130","text":"131"},[1620,1637],"[data.vote.deadline, loading, voteId]",[1546,1561],"[config, config.url, i]"]