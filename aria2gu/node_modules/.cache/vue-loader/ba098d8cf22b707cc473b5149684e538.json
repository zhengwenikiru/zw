{"remainingRequest":"/Users/zhengwen/aria2gu/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhengwen/aria2gu/src/views/Downloading.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhengwen/aria2gu/src/views/Downloading.vue","mtime":1638085055786},{"path":"/Users/zhengwen/aria2gu/node_modules/cache-loader/dist/cjs.js","mtime":1637998138681},{"path":"/Users/zhengwen/aria2gu/node_modules/babel-loader/lib/index.js","mtime":1637998138838},{"path":"/Users/zhengwen/aria2gu/node_modules/cache-loader/dist/cjs.js","mtime":1637998138681},{"path":"/Users/zhengwen/aria2gu/node_modules/vue-loader/lib/index.js","mtime":1637998138883}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIEAgaXMgYW4gYWxpYXMgdG8gL3NyYwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJEb3dubG9hZGluZyIsCiAgZGF0YSgpewogICAgcmV0dXJuewogICAgICB0YXNrczpbXSwKICAgICAgc2VsZWN0ZWQ6W10KICAgIH0KICB9LAogIG1vdW50ZWQoKXsKICAgIHRoaXMudXBkYXRlTGlzdCgpCiAgICB0aGlzLmludGVydmFsSWQgPSBzZXRJbnRlcnZhbChhc3luYygpPT57CiAgICAgIHRoaXMudXBkYXRlTGlzdCgpCiAgICB9LDEwMDApCiAgfSwKICBtZXRob2RzOnsKICAgIC8vIGdvRGV0YWlsKHRhc2spewogICAgLy8gICB0aGlzLiRyb3V0ZXIucHVzaCgnL3Rhc2svJyt0YXNrLmdpZCkKICAgIC8vIH0sCiAgIGFzeW5jIHVwZGF0ZUxpc3QoKXsKICAgICAgIHRoaXMudGFza3MgPSBbCiAgICAgICAgLi4uYXdhaXQgd2luZG93LmFyaWEyLnRlbGxBY3RpdmUoKSwKICAgICAgICAuLi5hd2FpdCB3aW5kb3cuYXJpYTIudGVsbFdhaXRpbmcoMCwxMDApXQogICAgfSwKICAgIC8vIOWvuemAieS4reeahOS7u+WKoeaJp+ihjOaTjeS9nCzmr4/mk43kvZzkuIDmrKHmm7TmlrDkuIDmrKHku7vliqHliJfooajnirbmgIEKICAgYXN5bmMgZXhlY1NlbGVjdGVkKGFjdGlvbil7CiAgICAgIGZvcihsZXQgZ2lkIG9mIHRoaXMuc2VsZWN0ZWQpewogICAgICAgYXdhaXQgd2luZG93LmFyaWEyW2FjdGlvbl0oZ2lkKQogICAgICB9CiAgICAgIHRoaXMudXBkYXRlTGlzdCgpCiAgICB9LAogICAgc2VsZWN0QWxsKCl7CiAgICAgIGlmKHRoaXMuc2VsZWN0ZWQubGVuZ3RoID09IHRoaXMudGFza3MubGVuZ3RoKXsKICAgICAgICB0aGlzLnNlbGVjdGVkPVtdCiAgICAgIH1lbHNlewogICAgICAgIHRoaXMuc2VsZWN0ZWQgPSB0aGlzLnRhc2tzLm1hcChpdCA9Pml0LmdpZCkKICAgICAgfQogICAgfSwKICAgIHRvZ2dsZVNlbGVjdGVkKCl7CiAgICAgIHZhciBpZHggPSB0aGlzLnNlbGVjdGVkLmluZGV4T2YodGFzay5naWQpCiAgICAgIGlmKGlkeCA9PS0xKXsKICAgICAgICB0aGlzLnNlbGVjdGVkLnB1c2godGFzay5naWQsdHJ1ZSkKICAgICAgfWVsc2V7CiAgICAgICAgdGhpcy5zZWxlY3RlZC5zcGxpY2UoaWR4LDEpCiAgICAgIH0KICAgIH0sCiAgICBnZXRGaWxlbmFtZSh0YXNrKXsKICAgICAgaWYodGFzay5maWxlcz8uWzBdLnBhdGgpewogICAgICAgIHJldHVybiB0YXNrLmZpbGVzWzBdLnBhdGguc3BsaXQoJy8nKS5hdCgtMSkKICAgICAgfWVsc2V7CiAgICAgICAgcmV0dXJuIHRhc2suZmlsZXM/LnVyaXM/LlswXT8udXJpLnNwbGl0KCcvJykuYXQoLTEpID8/ICfmnKrnn6UnCiAgICAgIH0KICAgIH0sCiAgICAgZ2V0UGVyY2VudCh0YXNrKSB7CiAgICAgIGlmICh0YXNrLmNvbXBsZXRlZExlbmd0aCA9PSAwKSB7CiAgICAgICAgcmV0dXJuIDAKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGFzay5jb21wbGV0ZWRMZW5ndGggLyB0YXNrLnRvdGFsTGVuZ3RoICogMTAwCiAgICAgIH0KICAgIH0sCiAgICAgfSwKICBiZWZvcmVEZXN0cm95KCl7CiAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJZCkKICB9LAogIGNvbXBvbmVudHM6IHsKICAKICB9LAp9Owo="},{"version":3,"sources":["Downloading.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Downloading.vue","sourceRoot":"src/views","sourcesContent":["<style lang=\"less\" scoped>\nul{\n  list-style: none;\n}\nli{\n  /* display: flex; */\n    cursor: pointer;\n  &.selected{\n    background-color: #ddd;\n  }\n  &:hover{\n    background-color: #eee;\n  }\n}\n</style>\n\n<template>\n  <div class=\"downloading\">\n  <h2>正在下载</h2>\n  <div>\n    <button @click=\"execSelected('pause')\">暂停</button>\n    <button @click=\"execSelected('unpause')\">开始</button>\n    <button @click=\"execSelected('remove')\">删除</button>\n    <button @click=\"selectAll\">全选</button>\n    </div>\n  <ul>\n    <li v-for=\"task of tasks\" :key = \"task.gid\" :class=\"{selected:selected.includes(task.gid)}\" @click=\"toggleSelect(task)\">\n      <input type=\"checkbox\" :checked=\"selected.includes(task.gid)\">\n      <span>{{ getFilename(task) }}</span>\n      |\n      <span>{{ getPercent(task) |fixed }}%</span>\n      |\n      <span>{{ task.downloadSpeed /1024 |fixed }}k/s</span>\n      |\n      <span>{{ task.status }}</span>\n      |\n      <!-- <button @click.stop=\"goDetail\">详情</button> -->\n      <router-link @click.native.stop :to=\"{name:'taskDetail',params:{gid:task.gid}}\">详情</router-link>\n      <!-- stop 使click事件不会冒泡到父元素上 -->\n    </li>\n  </ul>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\n\nexport default {\n  name: \"Downloading\",\n  data(){\n    return{\n      tasks:[],\n      selected:[]\n    }\n  },\n  mounted(){\n    this.updateList()\n    this.intervalId = setInterval(async()=>{\n      this.updateList()\n    },1000)\n  },\n  methods:{\n    // goDetail(task){\n    //   this.$router.push('/task/'+task.gid)\n    // },\n   async updateList(){\n       this.tasks = [\n        ...await window.aria2.tellActive(),\n        ...await window.aria2.tellWaiting(0,100)]\n    },\n    // 对选中的任务执行操作,每操作一次更新一次任务列表状态\n   async execSelected(action){\n      for(let gid of this.selected){\n       await window.aria2[action](gid)\n      }\n      this.updateList()\n    },\n    selectAll(){\n      if(this.selected.length == this.tasks.length){\n        this.selected=[]\n      }else{\n        this.selected = this.tasks.map(it =>it.gid)\n      }\n    },\n    toggleSelected(){\n      var idx = this.selected.indexOf(task.gid)\n      if(idx ==-1){\n        this.selected.push(task.gid,true)\n      }else{\n        this.selected.splice(idx,1)\n      }\n    },\n    getFilename(task){\n      if(task.files?.[0].path){\n        return task.files[0].path.split('/').at(-1)\n      }else{\n        return task.files?.uris?.[0]?.uri.split('/').at(-1) ?? '未知'\n      }\n    },\n     getPercent(task) {\n      if (task.completedLength == 0) {\n        return 0\n      } else {\n        return task.completedLength / task.totalLength * 100\n      }\n    },\n     },\n  beforeDestroy(){\n    clearInterval(this.intervalId)\n  },\n  components: {\n  \n  },\n};\n</script>\n"]}]}