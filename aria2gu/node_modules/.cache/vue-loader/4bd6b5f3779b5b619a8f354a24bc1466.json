{"remainingRequest":"/Users/zhengwen/Desktop/zw/aria2gu/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhengwen/Desktop/zw/aria2gu/src/views/Servers.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhengwen/Desktop/zw/aria2gu/src/views/Servers.vue","mtime":1639044448162},{"path":"/Users/zhengwen/Desktop/zw/aria2gu/node_modules/cache-loader/dist/cjs.js","mtime":1637998138681},{"path":"/Users/zhengwen/Desktop/zw/aria2gu/node_modules/babel-loader/lib/index.js","mtime":1637998138838},{"path":"/Users/zhengwen/Desktop/zw/aria2gu/node_modules/cache-loader/dist/cjs.js","mtime":1637998138681},{"path":"/Users/zhengwen/Desktop/zw/aria2gu/node_modules/vue-loader/lib/index.js","mtime":1637998138883}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgdmFyIHNlcnZlcnMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhcmlhMlNlcnZlcnMnKSkgfHwgW10KICAgIC8vIGpzb25wYXJzZeS4jeiDveino+aekHVuZGVmaW5lZCDnlKhnZXRJdGVt5bCx6IO96L+U5ZuebnVsbO+8jOiAjG51bGzmmK/og73op6PmnpDnmoQKICAgIHJldHVybiB7CiAgICAgIHNlcnZlcnM6IHNlcnZlcnMsCiAgICAgIGRpYWxvZ0Zvcm1WaXNpYmxlOiBmYWxzZSwKICAgICAgZWRpdEluZGV4OiAtMSwgLy8g5b2T5YmN5q2j5Zyo57yW6L6R55qE5pyN5Yqh5Zmo5LiL5qCH77yM5aaC5p6c5pivLTHooajnpLrmt7vliqAKICAgICAgbmV3U2VydmVyOiB7CiAgICAgICAgbmFtZTogJycsCiAgICAgICAgaG9zdDogJzEyNy4wLjAuMScsCiAgICAgICAgcG9ydDogNjgwMCwKICAgICAgICBzZWNyZXQ6ICcnLAogICAgICB9CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgc2VydmVycyhzZXJ2ZXJzKSB7CiAgICAgIGNvbnNvbGUubG9nKCdzZXJ2ZXJzIGNoYW5nZWQuLi4uJykKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FyaWEyU2VydmVycycsIEpTT04uc3RyaW5naWZ5KHNlcnZlcnMpKQogICAgICB0aGlzLiRlbWl0KCdzZXJ2ZXJzLWNoYW5nZWQnLCB0aGlzLnNlcnZlcnMpCiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgcmVtb3ZlU2VydmVyKGlkeCkgewogICAgICB0cnkgewogICAgICAgIGF3YWl0IHRoaXMuJGNvbmZpcm0oJ+ehruWumuimgeWIoOmZpOWQl++8nycpCiAgICAgICAgdGhpcy5zZXJ2ZXJzLnNwbGljZShpZHgsIDEpCiAgICAgIH0gY2F0Y2goZSkgewogICAgICAgIGlmIChlID09ICdjYW5jZWwnKSB7CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBlCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgZWRpdFNlcnZlcihpZHgpIHsKICAgICAgdGhpcy5lZGl0SW5kZXggPSBpZHgKICAgICAgdmFyIHRhcmdldFNlcnZlciA9IHRoaXMuc2VydmVyc1tpZHhdCgogICAgICBPYmplY3QuYXNzaWduKHRoaXMubmV3U2VydmVyLCB0YXJnZXRTZXJ2ZXIpCgogICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZQogICAgfSwvLyDmmL7npLrnvJbovpHpobXpnaLvvIzlubblsIblvZPliY3nvJbovpHnmoTmnI3liqHlmajkv6Hmga/kvKDliLDnvJbovpHpobXpnaIKICAgIGFkZFNlcnZlcigpIHsKICAgICAgaWYgKHRoaXMuZWRpdEluZGV4ID09IC0xKSB7IC8vIOa3u+WKoOacjeWKoeWZqAogICAgICAgIHRoaXMuc2VydmVycy5wdXNoKHRoaXMubmV3U2VydmVyKQogICAgICAgIHRoaXMubmV3U2VydmVyID0gewogICAgICAgICAgaG9zdDogJzEyNy4wLjAuMScsCiAgICAgICAgICBwb3J0OiA2ODAwLAogICAgICAgICAgc2VjcmV0OiAnJywKICAgICAgICB9CiAgICAgIH0gZWxzZSB7IC8vIOS/ruaUueeOsOWtmOeahOacjeWKoeWZqAogICAgICAgIGNvbnNvbGUubG9nKCdjaGFuZ2VkIHNlcnZlcicpCiAgICAgICAgLy8gdGhpcy5zZXJ2ZXJzW3RoaXMuZWRpdEluZGV4XSA9IHRoaXMubmV3U2VydmVyCiAgICAgICAgdGhpcy5zZXJ2ZXJzLnNwbGljZSh0aGlzLmVkaXRJbmRleCwgMSwgdGhpcy5uZXdTZXJ2ZXIpCiAgICAgICAgLy8gVnVlLnNldCh0aGlzLnNlcnZlcnMsIHRoaXMuZWRpdEluZGV4LCB0aGlzLm5ld1NlcnZlcikKICAgICAgICB0aGlzLm5ld1NlcnZlciA9IHsKICAgICAgICAgIGhvc3Q6ICcxMjcuMC4wLjEnLAogICAgICAgICAgcG9ydDogNjgwMCwKICAgICAgICAgIHNlY3JldDogJycsCiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKfQo="},{"version":3,"sources":["Servers.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Servers.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <h2>管理服务器</h2>\n    <button @click=\"dialogFormVisible = true; editIndex = -1\">添加</button>\n\n    <el-dialog title=\"添加服务器\" :visible.sync=\"dialogFormVisible\">\n\n      <el-form :model=\"newServer\">\n        <el-form-item label=\"Name\" label-width=\"80px\">\n          <el-input v-model=\"newServer.name\" auto-complete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"Host\" label-width=\"80px\">\n          <el-input v-model=\"newServer.host\" :min=\"1\" :max=\"65535\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"Port\" label-width=\"80px\">\n          <el-input-number v-model=\"newServer.port\" auto-complete=\"off\"></el-input-number>\n        </el-form-item>\n        <el-form-item label=\"Secret\" label-width=\"80px\">\n          <el-input type=\"password\" v-model=\"newServer.secret\" auto-complete=\"off\"></el-input>\n        </el-form-item>\n      </el-form>\n\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"dialogFormVisible = false; addServer()\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n    <ul>\n      <li v-for=\"(server, idx) of servers\" :key=\"idx\">\n        Name: {{ server.name }}\n        Host: {{ server.host }}\n        Port: {{ server.port}}\n        Secret: <input type=\"password\" :value=\"server.secret\" />\n        <button @click=\"removeServer(idx)\">删除</button>\n        <button @click=\"editServer(idx)\">编辑</button>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    var servers = JSON.parse(localStorage.getItem('aria2Servers')) || []\n    // jsonparse不能解析undefined 用getItem就能返回null，而null是能解析的\n    return {\n      servers: servers,\n      dialogFormVisible: false,\n      editIndex: -1, // 当前正在编辑的服务器下标，如果是-1表示添加\n      newServer: {\n        name: '',\n        host: '127.0.0.1',\n        port: 6800,\n        secret: '',\n      }\n    }\n  },\n  watch: {\n    servers(servers) {\n      console.log('servers changed....')\n      localStorage.setItem('aria2Servers', JSON.stringify(servers))\n      this.$emit('servers-changed', this.servers)\n    },\n  },\n  methods: {\n    async removeServer(idx) {\n      try {\n        await this.$confirm('确定要删除吗？')\n        this.servers.splice(idx, 1)\n      } catch(e) {\n        if (e == 'cancel') {\n\n        } else {\n          throw e\n        }\n      }\n    },\n    editServer(idx) {\n      this.editIndex = idx\n      var targetServer = this.servers[idx]\n\n      Object.assign(this.newServer, targetServer)\n\n      this.dialogFormVisible = true\n    },// 显示编辑页面，并将当前编辑的服务器信息传到编辑页面\n    addServer() {\n      if (this.editIndex == -1) { // 添加服务器\n        this.servers.push(this.newServer)\n        this.newServer = {\n          host: '127.0.0.1',\n          port: 6800,\n          secret: '',\n        }\n      } else { // 修改现存的服务器\n        console.log('changed server')\n        // this.servers[this.editIndex] = this.newServer\n        this.servers.splice(this.editIndex, 1, this.newServer)\n        // Vue.set(this.servers, this.editIndex, this.newServer)\n        this.newServer = {\n          host: '127.0.0.1',\n          port: 6800,\n          secret: '',\n        }\n      }\n    }\n  },\n}\n</script>\n"]}]}