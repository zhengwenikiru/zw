{"remainingRequest":"/Users/zhengwen/aria2gu/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhengwen/aria2gu/src/views/Downloading.vue?vue&type=style&index=0&id=36fefd10&lang=less&scoped=true&","dependencies":[{"path":"/Users/zhengwen/aria2gu/src/views/Downloading.vue","mtime":1638085055786},{"path":"/Users/zhengwen/aria2gu/node_modules/css-loader/dist/cjs.js","mtime":1637998138772},{"path":"/Users/zhengwen/aria2gu/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1637998138938},{"path":"/Users/zhengwen/aria2gu/node_modules/postcss-loader/src/index.js","mtime":1637998138837},{"path":"/Users/zhengwen/aria2gu/node_modules/less-loader/dist/cjs.js","mtime":1637998143422},{"path":"/Users/zhengwen/aria2gu/node_modules/cache-loader/dist/cjs.js","mtime":1637998138681},{"path":"/Users/zhengwen/aria2gu/node_modules/vue-loader/lib/index.js","mtime":1637998138883}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CnVsewogIGxpc3Qtc3R5bGU6IG5vbmU7Cn0KbGl7CiAgLyogZGlzcGxheTogZmxleDsgKi8KICAgIGN1cnNvcjogcG9pbnRlcjsKICAmLnNlbGVjdGVkewogICAgYmFja2dyb3VuZC1jb2xvcjogI2RkZDsKICB9CiAgJjpob3ZlcnsKICAgIGJhY2tncm91bmQtY29sb3I6ICNlZWU7CiAgfQp9Cg=="},{"version":3,"sources":["Downloading.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Downloading.vue","sourceRoot":"src/views","sourcesContent":["<style lang=\"less\" scoped>\nul{\n  list-style: none;\n}\nli{\n  /* display: flex; */\n    cursor: pointer;\n  &.selected{\n    background-color: #ddd;\n  }\n  &:hover{\n    background-color: #eee;\n  }\n}\n</style>\n\n<template>\n  <div class=\"downloading\">\n  <h2>正在下载</h2>\n  <div>\n    <button @click=\"execSelected('pause')\">暂停</button>\n    <button @click=\"execSelected('unpause')\">开始</button>\n    <button @click=\"execSelected('remove')\">删除</button>\n    <button @click=\"selectAll\">全选</button>\n    </div>\n  <ul>\n    <li v-for=\"task of tasks\" :key = \"task.gid\" :class=\"{selected:selected.includes(task.gid)}\" @click=\"toggleSelect(task)\">\n      <input type=\"checkbox\" :checked=\"selected.includes(task.gid)\">\n      <span>{{ getFilename(task) }}</span>\n      |\n      <span>{{ getPercent(task) |fixed }}%</span>\n      |\n      <span>{{ task.downloadSpeed /1024 |fixed }}k/s</span>\n      |\n      <span>{{ task.status }}</span>\n      |\n      <!-- <button @click.stop=\"goDetail\">详情</button> -->\n      <router-link @click.native.stop :to=\"{name:'taskDetail',params:{gid:task.gid}}\">详情</router-link>\n      <!-- stop 使click事件不会冒泡到父元素上 -->\n    </li>\n  </ul>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\n\nexport default {\n  name: \"Downloading\",\n  data(){\n    return{\n      tasks:[],\n      selected:[]\n    }\n  },\n  mounted(){\n    this.updateList()\n    this.intervalId = setInterval(async()=>{\n      this.updateList()\n    },1000)\n  },\n  methods:{\n    // goDetail(task){\n    //   this.$router.push('/task/'+task.gid)\n    // },\n   async updateList(){\n       this.tasks = [\n        ...await window.aria2.tellActive(),\n        ...await window.aria2.tellWaiting(0,100)]\n    },\n    // 对选中的任务执行操作,每操作一次更新一次任务列表状态\n   async execSelected(action){\n      for(let gid of this.selected){\n       await window.aria2[action](gid)\n      }\n      this.updateList()\n    },\n    selectAll(){\n      if(this.selected.length == this.tasks.length){\n        this.selected=[]\n      }else{\n        this.selected = this.tasks.map(it =>it.gid)\n      }\n    },\n    toggleSelected(){\n      var idx = this.selected.indexOf(task.gid)\n      if(idx ==-1){\n        this.selected.push(task.gid,true)\n      }else{\n        this.selected.splice(idx,1)\n      }\n    },\n    getFilename(task){\n      if(task.files?.[0].path){\n        return task.files[0].path.split('/').at(-1)\n      }else{\n        return task.files?.uris?.[0]?.uri.split('/').at(-1) ?? '未知'\n      }\n    },\n     getPercent(task) {\n      if (task.completedLength == 0) {\n        return 0\n      } else {\n        return task.completedLength / task.totalLength * 100\n      }\n    },\n     },\n  beforeDestroy(){\n    clearInterval(this.intervalId)\n  },\n  components: {\n  \n  },\n};\n</script>\n"]}]}